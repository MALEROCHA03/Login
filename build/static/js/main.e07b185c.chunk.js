(this["webpackJsonpchat-app"]=this["webpackJsonpchat-app"]||[]).push([[0],{151:function(e,t,n){},157:function(e,t,n){},160:function(e,t,n){},162:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n(0),r=n(18),s=n.n(r),o=n(12),i=n.n(o),l=n(23),u=n(4),j="https://backchat1.herokuapp.com/api",b=function(){var e=Object(l.a)(i.a.mark((function e(t,n){var a,c,r,s,o=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=o.length>2&&void 0!==o[2]?o[2]:"GET",c="".concat(j,"/").concat(t),"GET"!==a){e.next=11;break}return e.next=5,fetch(c);case 5:return r=e.sent,e.next=8,r.json();case 8:return e.abrupt("return",e.sent);case 11:return e.next=13,fetch(c,{method:a,headers:{"Content-type":"application/json"},body:JSON.stringify(n)});case 13:return s=e.sent,e.next=16,s.json();case 16:return e.abrupt("return",e.sent);case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),d=function(){var e=Object(l.a)(i.a.mark((function e(t,n){var a,c,r,s,o,l=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=l.length>2&&void 0!==l[2]?l[2]:"GET",c="".concat(j,"/").concat(t),r=localStorage.getItem("token")||"","GET"!==a){e.next=12;break}return e.next=6,fetch(c,{headers:{"x-token":r}});case 6:return s=e.sent,e.next=9,s.json();case 9:return e.abrupt("return",e.sent);case 12:return e.next=14,fetch(c,{method:a,headers:{"Content-type":"application/json","x-token":r},body:JSON.stringify(n)});case 14:return o=e.sent,e.next=17,o.json();case 17:return e.abrupt("return",e.sent);case 18:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),m=n(32),p=n(2),h="[Chat] Usuarios cargados",O="[Chat] Activar Chat",f="[Chat] Nuevo Mensaje",x="[Chat] Cargar Mensajes",g="[Chat] Cerrar sesi\xf3n",v=function(e,t){switch(t.type){case g:return{uid:"",activeChat:null,users:[],messages:[]};case h:return Object(p.a)(Object(p.a)({},e),{},{users:Object(m.a)(t.payload)});case O:return e.activeChat===t.payload?e:Object(p.a)(Object(p.a)({},e),{},{activeChat:t.payload,messages:[]});case f:return e.activeChat===t.payload.from||e.activeChat===t.payload.to?Object(p.a)(Object(p.a)({},e),{},{messages:[].concat(Object(m.a)(e.messages),[t.payload])}):e;case x:return Object(p.a)(Object(p.a)({},e),{},{messages:Object(m.a)(t.payload)});default:return e}},k=Object(c.createContext)(),N={uid:"",activeChat:null,users:[],mensajes:[]},w=function(e){var t=e.children,n=Object(c.useReducer)(v,N),r=Object(u.a)(n,2),s=r[0],o=r[1];return Object(a.jsx)(k.Provider,{value:{chatState:s,dispatch:o},children:t})},C=Object(c.createContext)(),y={uid:null,checking:!0,logged:!1,name:null,email:null,position:null},S=function(e){var t=e.children,n=Object(c.useState)(y),r=Object(u.a)(n,2),s=r[0],o=r[1],j=Object(c.useContext)(k).dispatch,m=function(){var e=Object(l.a)(i.a.mark((function e(t,n){var a,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b("login",{email:t,password:n},"POST");case 2:return(a=e.sent).ok&&(localStorage.setItem("token",a.token),c=a.user,o({uid:c.uid,checking:!1,logged:!0,name:c.name,email:c.email,position:c.position})),e.abrupt("return",a.ok);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),p=function(){var e=Object(l.a)(i.a.mark((function e(t,n,a,c){var r,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b("login/new",{name:t,email:n,password:a,position:c},"POST");case 2:if(!(r=e.sent).ok){e.next=8;break}return localStorage.setItem("token",r.token),s=r.user,o({uid:s.uid,checking:!1,logged:!0,name:s.name,email:s.email,position:s.position}),e.abrupt("return",!0);case 8:return e.abrupt("return",r.msg);case 9:case"end":return e.stop()}}),e)})));return function(t,n,a,c){return e.apply(this,arguments)}}(),h=Object(c.useCallback)(Object(l.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(localStorage.getItem("token")){e.next=4;break}return o({uid:null,checking:!1,logged:!1,name:null,email:null,position:null}),e.abrupt("return",!1);case 4:return e.next=6,d("login/renew");case 6:if(!(t=e.sent).ok){e.next=15;break}return console.log(t),localStorage.setItem("token",t.token),n=t.user,o({uid:n.uid,checking:!1,logged:!0,name:n.name,email:n.email,position:n.position}),e.abrupt("return",!0);case 15:return o({uid:null,checking:!1,logged:!1,name:null,email:null,position:null}),e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e)}))),[]);return Object(a.jsx)(C.Provider,{value:{auth:s,login:m,register:p,verificaToken:h,logout:function(){localStorage.removeItem("token"),j({type:g}),o({checking:!1,logged:!1})}},children:t})},E=n(99),I=n.n(E),A=n(80),T=Object(c.createContext)(),P=function(e){var t=e.children,n=function(e){var t=Object(c.useState)(null),n=Object(u.a)(t,2),a=n[0],r=n[1],s=Object(c.useState)(!1),o=Object(u.a)(s,2),i=o[0],l=o[1],j=Object(c.useCallback)((function(){var t=localStorage.getItem("token"),n=I.a.connect(e,{transports:["websocket"],autoConnect:!0,forceNew:!0,query:{"x-token":t}});r(n)}),[e]),b=Object(c.useCallback)((function(){null===a||void 0===a||a.disconnect()}),[a]);return Object(c.useEffect)((function(){l(null===a||void 0===a?void 0:a.connected)}),[a]),Object(c.useEffect)((function(){null===a||void 0===a||a.on("connect",(function(){return l(!0)}))}),[a]),Object(c.useEffect)((function(){null===a||void 0===a||a.on("disconnect",(function(){return l(!1)}))}),[a]),{socket:a,online:i,conectarSocket:j,desconectarSocket:b}}("https://backchat1.herokuapp.com"),r=n.socket,s=n.online,o=n.conectarSocket,i=n.desconectarSocket,l=Object(c.useContext)(C).auth,j=Object(c.useContext)(k).dispatch;return Object(c.useEffect)((function(){l.logged&&o()}),[l,o]),Object(c.useEffect)((function(){l.logged||i()}),[l,i]),Object(c.useEffect)((function(){null===r||void 0===r||r.on("user-list",(function(e){j({type:h,payload:e})}))}),[r,j]),Object(c.useEffect)((function(){null===r||void 0===r||r.on("personal-message",(function(e){var t;console.log(e),j({type:f,payload:e}),t="mensajes",A.animateScroll.scrollToBottom({containerId:t,duration:250})}))}),[r,j]),Object(a.jsx)(T.Provider,{value:{socket:r,online:s},children:t})},D=n(31),G=n(10),J=n.p+"static/media/CODE.45102a09.png",R=function(){return Object(a.jsx)("div",{className:"",children:Object(a.jsx)("img",{src:J})})},_=n(171),B=n(169),L=n(172),q=n(170),M=function(){var e=Object(c.useContext)(C),t=e.auth,n=e.logout;return Object(a.jsx)(_.a,{expand:"lg",className:"nav",children:Object(a.jsxs)(B.a,{children:[Object(a.jsx)(_.a.Brand,{href:"#home",children:Object(a.jsxs)("div",{className:"headind_srch",children:[Object(a.jsx)("div",{className:"recent_heading mt-2",children:Object(a.jsx)("h4",{children:t.name})}),Object(a.jsx)("div",{className:"srch_bar",children:Object(a.jsx)("div",{className:"stylish-input-group",children:Object(a.jsx)("box-icon",{onClick:n,name:"exit",type:"solid",color:"#ffffff",style:{cursor:"pointer"}})})})]})}),Object(a.jsx)(_.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(a.jsx)(_.a.Collapse,{id:"basic-navbar-nav",children:Object(a.jsxs)(L.a,{className:"me-auto",children:[Object(a.jsx)(L.a.Link,{href:"#home",children:"Home"}),Object(a.jsx)(L.a.Link,{href:"#link",children:"Link"}),Object(a.jsxs)(q.a,{title:"Dropdown",id:"basic-nav-dropdown",children:[Object(a.jsx)(q.a.Item,{href:"#action/3.1",children:"Action"}),Object(a.jsx)(q.a.Item,{href:"#action/3.2",children:"Another action"}),Object(a.jsx)(q.a.Item,{href:"#action/3.3",children:"Something"}),Object(a.jsx)(q.a.Divider,{}),Object(a.jsx)(q.a.Item,{href:"#action/3.4",children:"Separated link"})]})]})})]})})},H=function(){return Object(a.jsxs)("div",{className:"inbox_people",children:[Object(a.jsx)(M,{}),Object(a.jsx)(R,{})]})},U=(n(151),function(){return Object(a.jsx)(H,{})}),V=n(7),Y=n(63),z=n.n(Y),F=n.p+"static/media/AR.64b86d54.png",K=function(){var e=Object(c.useContext)(C).login,t=Object(c.useState)({email:"",password:"",rememberme:!1}),n=Object(u.a)(t,2),r=n[0],s=n[1];Object(c.useEffect)((function(){var e=localStorage.getItem("email");e&&s((function(t){return Object(p.a)(Object(p.a)({},t),{},{email:e,rememberme:!0})}))}),[]);var o=function(e){var t=e.target,n=t.name,a=t.value;s(Object(p.a)(Object(p.a)({},r),{},Object(V.a)({},n,a)))},j=function(){var t=Object(l.a)(i.a.mark((function t(n){var a,c;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),r.rememberme?localStorage.setItem("email",r.email):localStorage.removeItem("email"),a=r.email,c=r.password,t.next=5,e(a,c);case 5:t.sent||z.a.fire("Error","Verifique el usuario y contrase\xf1a","error");case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(a.jsx)("div",{children:Object(a.jsxs)("form",{className:"login100-form validate-form flex-sb flex-w",onSubmit:j,children:[Object(a.jsx)("img",{className:"logoInstopol",src:F,alt:"logo"}),Object(a.jsx)("span",{className:"login100-form-title mb-3"}),Object(a.jsxs)("div",{className:"wrap-input100 validate-input mb-3",children:[Object(a.jsx)("input",{className:"input100",type:"email",name:"email",placeholder:"Email",value:r.email,onChange:o}),Object(a.jsx)("span",{className:"focus-input100"})]}),Object(a.jsxs)("div",{className:"wrap-input100 validate-input mb-3",children:[Object(a.jsx)("input",{className:"input100",type:"password",name:"password",placeholder:"Password",value:r.password,onChange:o}),Object(a.jsx)("span",{className:"focus-input100"})]}),Object(a.jsxs)("div",{className:"row mb-3",children:[Object(a.jsxs)("div",{className:"col",onClick:function(){return console.log("??"),void s(Object(p.a)(Object(p.a)({},r),{},{rememberme:!r.rememberme}))},children:[Object(a.jsx)("input",{className:"input-checkbox100",id:"ckb1",type:"checkbox",name:"rememberme",checked:r.rememberme,readOnly:!0}),Object(a.jsx)("label",{className:"label-checkbox100",children:"Recordarme"})]}),Object(a.jsx)("div",{className:"col text-right",children:Object(a.jsx)(D.b,{to:"/auth/register",className:"txt1",children:"Nueva cuenta?"})})]}),Object(a.jsx)("div",{className:"container-login100-form-btn m-t-17",children:Object(a.jsx)("button",{type:"submit",className:"login100-form-btn",disabled:!(r.email.length>0&&r.password.length>0),children:"Ingresar"})})]})})},Q=function(){var e=Object(c.useContext)(C).register,t=Object(c.useState)({email:"",password:"",name:"",position:""}),n=Object(u.a)(t,2),r=n[0],s=n[1],o=function(e){var t=e.target,n=t.name,a=t.value;s(Object(p.a)(Object(p.a)({},r),{},Object(V.a)({},n,a)))},j=function(){var t=Object(l.a)(i.a.mark((function t(n){var a,c,s,o,l;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),a=r.email,c=r.password,s=r.name,o=r.position,t.next=4,e(s,a,c,o);case 4:!0!==(l=t.sent)&&z.a.fire("Error",l,"error");case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(a.jsxs)("form",{className:"login100-form validate-form flex-sb flex-w",onSubmit:j,children:[Object(a.jsx)("img",{className:"logoInstopol",src:F,alt:"logo"}),Object(a.jsx)("span",{className:"login100-form-title mb-3",children:"Registrate"}),Object(a.jsxs)("div",{className:"wrap-input100 validate-input mb-3",children:[Object(a.jsx)("input",{className:"input100",type:"text",name:"name",placeholder:"Nombre",value:r.name,onChange:o}),Object(a.jsx)("span",{className:"focus-input100"})]}),Object(a.jsxs)("div",{className:"wrap-input100 validate-input mb-3",children:[Object(a.jsx)("input",{className:"input100",type:"text",name:"position",placeholder:"Cargo",value:r.position,onChange:o}),Object(a.jsx)("span",{className:"focus-input100"})]}),Object(a.jsxs)("div",{className:"wrap-input100 validate-input mb-3",children:[Object(a.jsx)("input",{className:"input100",type:"email",name:"email",placeholder:"Email",value:r.email,onChange:o}),Object(a.jsx)("span",{className:"focus-input100"})]}),Object(a.jsxs)("div",{className:"wrap-input100 validate-input mb-3",children:[Object(a.jsx)("input",{className:"input100",type:"password",name:"password",placeholder:"Password",value:r.password,onChange:o}),Object(a.jsx)("span",{className:"focus-input100"})]}),Object(a.jsx)("div",{className:"row mb-3",children:Object(a.jsx)("div",{className:"col text-right",children:Object(a.jsx)(D.b,{to:"/auth/login",className:"txt1",children:"Ya tienes cuenta?"})})}),Object(a.jsx)("div",{className:"container-login100-form-btn m-t-17",children:Object(a.jsx)("button",{type:"submit",className:"login100-form-btn",disabled:!(r.email.length>0&&r.password.length>0&&r.name.length>0&&r.position.length>0),children:"Crear cuenta"})})]})},W=(n(157),function(){return Object(a.jsx)("div",{className:"limiter",children:Object(a.jsx)("div",{className:"container-login100",children:Object(a.jsx)("div",{className:"wrap-login100 p-t-50 p-b-90",children:Object(a.jsxs)(G.d,{children:[Object(a.jsx)(G.b,{exact:!0,path:"/auth/login",component:K}),Object(a.jsx)(G.b,{exact:!0,path:"/auth/register",component:Q}),Object(a.jsx)(G.a,{to:"/auth/login"})]})})})})}),X=n(3),Z=function(e){var t=e.isAuthenticated,n=e.component,c=Object(X.a)(e,["isAuthenticated","component"]);return Object(a.jsx)(G.b,Object(p.a)(Object(p.a)({},c),{},{component:function(e){return t?Object(a.jsx)(G.a,{to:"/"}):Object(a.jsx)(n,Object(p.a)({},e))}}))},$=function(e){var t=e.isAuthenticated,n=e.component,c=Object(X.a)(e,["isAuthenticated","component"]);return Object(a.jsx)(G.b,Object(p.a)(Object(p.a)({},c),{},{component:function(e){return t?Object(a.jsx)(n,Object(p.a)({},e)):Object(a.jsx)(G.a,{to:"/auth"})}}))},ee=function(){var e=Object(c.useContext)(C),t=e.auth,n=e.verificaToken;return Object(c.useEffect)((function(){n()}),[n]),t.checking?Object(a.jsx)("h1",{children:"Espere por favor"}):Object(a.jsx)(D.a,{children:Object(a.jsx)("div",{children:Object(a.jsxs)(G.d,{children:[Object(a.jsx)(Z,{isAuthenticated:t.logged,path:"/auth",component:W}),Object(a.jsx)($,{isAuthenticated:t.logged,exact:!0,path:"/",component:U}),Object(a.jsx)(G.a,{to:"/"})]})})})},te=n(79),ne=n.n(te);n(159);ne.a.locale("es");var ae=function(){return Object(a.jsx)(w,{children:Object(a.jsx)(S,{children:Object(a.jsx)(P,{children:Object(a.jsx)(ee,{})})})})};n(160),n(161);s.a.render(Object(a.jsx)(ae,{}),document.getElementById("root"))}},[[162,1,2]]]);
//# sourceMappingURL=main.e07b185c.chunk.js.map